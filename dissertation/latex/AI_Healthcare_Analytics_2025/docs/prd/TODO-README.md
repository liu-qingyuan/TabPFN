# PANDA-Heart 项目 TODO List

## 🎯 项目总览

**项目名称**: PANDA-Heart: 心脏病多中心跨域诊断
**目标**: 基于PANDA框架实现UCI心脏病多中心数据的跨域诊断
**周期**: 12周
**状态**: 🟢 规划阶段

---

## 📋 核心模块任务清单

### 🗂️ 数据处理模块
**文件**: `data/heart_disease_loader.py`

- [ ] **TASK-001**: 下载UCI心脏病多中心数据
  - [ ] Cleveland Clinic Foundation (303样本)
  - [ ] Hungarian Institute of Cardiology (294样本)
  - [ ] V.A. Medical Center (200样本)
  - [ ] University Hospital Zurich (123样本)
  - **优先级**: 🔥 High | **预计工时**: 4小时

- [ ] **TASK-002**: 实现数据加载和清洗
  - [ ] 统一14个特征的数据格式
  - [ ] 缺失值处理策略（多重插补）
  - [ ] 临床合理性验证
  - **优先级**: 🔥 High | **预计工时**: 8小时

- [ ] **TASK-003**: 特征编码和标准化
  - [ ] 分类变量编码（有序+独热）
  - [ ] 连续变量临床标准化
  - [ ] 年龄调整心率计算
  - **优先级**: 🔥 High | **预计工时**: 6小时

### 🤖 PANDA适配器模块
**文件**: `models/panda_heart_adapter.py`

- [ ] **TASK-004**: PANDA框架心脏病数据适配
  - [ ] 32成员集成配置
  - [ ] 心脏病专用特征变换
  - [ ] 类别不平衡处理
  - **优先级**: 🔥 High | **预计工时**: 12小时

- [ ] **TASK-005**: 不确定性量化实现
  - [ ] 预测不确定性估计
  - [ ] 置信区间计算
  - [ ] 可靠性评分
  - **优先级**: 🟡 Medium | **预计工时**: 6小时

- [ ] **TASK-006**: 临床约束优化
  - [ ] 特征重要性约束
  - [ ] 生理范围限制
  - [ ] 医学知识融入
  - **优先级**: 🟡 Medium | **预计工时**: 8小时

### 📊 评估工具模块
**文件**: `evaluation/heart_disease_metrics.py`

- [ ] **TASK-007**: 医学专用评估指标
  - [ ] AUC-ROC/AUC-PR计算
  - [ ] 敏感性/特异性/NPV
  - [ ] 校准指标（Brier Score, Calibration Slope）
  - **优先级**: 🔥 High | **预计工时**: 6小时

- [ ] **TASK-008**: 跨域适应效果评估
  - [ ] 性能保持率计算
  - [ ] 分布对齐度评估
  - [ ] 失败率分析
  - **优先级**: 🔥 High | **预计工时**: 4小时

- [ ] **TASK-009**: 临床可解释性评估
  - [ ] 特征重要性分析
  - [ ] SHAP值计算
  - [ ] 临床一致性验证
  - **优先级**: 🟡 Medium | **预计工时**: 8小时

### 🚀 主实验脚本
**文件**: `scripts/run_heart_disease_analysis.py`

- [ ] **TASK-010**: 单中心交叉验证实验
  - [ ] 各中心10折CV实现
  - [ ] 基线性能评估
  - [ ] 结果统计和可视化
  - **优先级**: 🔥 High | **预计工时**: 8小时

- [ ] **TASK-011**: 两中心跨域适应实验
  - [ ] 所有可能的源域-目标域组合
  - [ ] TCA/CORAL/SA方法对比
  - [ ] 性能提升分析
  - **优先级**: 🔥 High | **预计工时**: 12小时

- [ ] **TASK-012**: 多中心集成学习实验
  - [ ] LOCO-CV实现
  - [ ] 多源域融合策略
  - [ ] 渐进式域适应
  - **优先级**: 🟡 Medium | **预计工时**: 10小时

### 🔧 特征工程模块
**文件**: `features/clinical_feature_engineering.py`

- [ ] **TASK-013**: 临床特征子集构建
  - [ ] 基础生命体征（4特征）
  - [ ] 心脏特异性特征（5特征）
  - [ ] 临床指南推荐（8特征）
  - **优先级**: 🔥 High | **预计工时**: 4小时

- [ ] **TASK-014**: 交互特征生成
  - [ ] 年龄交互特征
  - [ ] 风险因素组合
  - [ ] 临床比值指标
  - **优先级**: 🟡 Medium | **预计工时**: 6小时

### 🌐 域适应模块
**文件**: `uda/heart_domain_adaptation.py`

- [ ] **TASK-015**: TCA心脏病优化
  - [ ] 线性核TCA实现
  - [ ] 临床约束集成
  - [ ] 超参数自适应
  - **优先级**: 🔥 High | **预计工时**: 8小时

- [ ] **TASK-016**: 多方法集成
  - [ ] CORAL实现
  - [ ] SA实现
  - [ ] 方法融合策略
  - **优先级**: 🟡 Medium | **预计工时**: 10小时

### 📈 可视化模块
**文件**: `visualization/heart_disease_viz.py`

- [ ] **TASK-017**: 学术级图表生成
  - [ ] ROC曲线对比图
  - [ ] 校准曲线图
  - [ ] 决策曲线分析图
  - **优先级**: 🔥 High | **预计工时**: 8小时

- [ ] **TASK-018**: 跨域分析可视化
  - [ ] 分布对齐效果图
  - [ ] 特征重要性对比
  - [ ] 性能保持率热图
  - **优先级**: 🟡 Medium | **预计工时**: 6小时

### ⚙️ 配置文件模块
**文件**: `config/heart_disease_config.py`

- [ ] **TASK-019**: 实验配置管理
  - [ ] 数据集映射配置
  - [ ] 特征集配置
  - [ ] 超参数配置
  - **优先级**: 🔥 High | **预计工时**: 4小时

- [ ] **TASK-020**: 结果路径管理
  - [ ] 时间戳目录生成
  - [ ] 文件命名规范
  - [ ] 结果版本控制
  - **优先级**: 🟡 Medium | **预计工时**: 2小时

### 🧪 测试模块
**文件**: `tests/test_heart_disease_pipeline.py`

- [ ] **TASK-021**: 单元测试编写
  - [ ] 数据加载测试
  - [ ] PANDA模型测试
  - [ ] 评估指标测试
  - **优先级**: 🟡 Medium | **预计工时**: 8小时

- [ ] **TASK-022**: 集成测试实现
  - [ ] 端到端流程测试
  - [ ] 结果一致性验证
  - [ ] 性能回归测试
  - **优先级**: 🟡 Medium | **预计工时**: 6小时

---

## 📅 实施时间表

### Phase 1: 基础设施搭建 (第1-2周)
- [ ] TASK-001: 数据下载 (4小时)
- [ ] TASK-002: 数据清洗 (8小时)
- [ ] TASK-003: 特征编码 (6小时)
- [ ] TASK-019: 配置管理 (4小时)
- [ ] **总计**: 22小时

### Phase 2: 模型适配 (第3-4周)
- [ ] TASK-004: PANDA适配 (12小时)
- [ ] TASK-005: 不确定性量化 (6小时)
- [ ] TASK-006: 临床约束 (8小时)
- [ ] TASK-007: 评估指标 (6小时)
- [ ] **总计**: 32小时

### Phase 3: 实验实现 (第5-8周)
- [ ] TASK-010: 单中心实验 (8小时)
- [ ] TASK-011: 两中心实验 (12小时)
- [ ] TASK-012: 多中心实验 (10小时)
- [ ] TASK-013: 特征工程 (4小时)
- [ ] **总计**: 34小时

### Phase 4: 高级功能 (第9-10周)
- [ ] TASK-015: 域适应优化 (8小时)
- [ ] TASK-016: 多方法集成 (10小时)
- [ ] TASK-017: 可视化生成 (8小时)
- [ ] TASK-008: 跨域评估 (4小时)
- [ ] **总计**: 30小时

### Phase 5: 测试与文档 (第11-12周)
- [ ] TASK-021: 单元测试 (8小时)
- [ ] TASK-022: 集成测试 (6小时)
- [ ] TASK-018: 高级可视化 (6小时)
- [ ] 文档撰写和整理
- [ ] **总计**: 20小时

---

## 🎯 里程碑检查点

### 🟢 Milestone 1: 数据就绪 (Week 2)
- **目标**: 完成数据下载、清洗和基础预处理
- **验收标准**: 4个中心数据格式统一，缺失值处理完成

### 🟡 Milestone 2: 模型运行 (Week 4)
- **目标**: PANDA框架成功适配心脏病数据
- **验收标准**: 单中心10折CV实验可正常运行

### 🟠 Milestone 3: 跨域验证 (Week 8)
- **目标**: 完成跨域适应实验
- **验收标准**: 两中心域适应结果优于基线

### 🔴 Milestone 4: 完整验证 (Week 12)
- **目标**: 完成所有实验和评估
- **验收标准**: 全部TODO项目完成，可撰写论文

---

## 🚨 风险预警

### 高风险项目
- ⚠️ **TASK-011**: 两中心跨域实验（复杂度高）
- ⚠️ **TASK-012**: 多中心集成（技术挑战）
- ⚠️ **TASK-015**: TCA优化（调参复杂）

### 依赖关系
- TASK-004 依赖 TASK-003（特征编码）
- TASK-010 依赖 TASK-007（评估指标）
- TASK-011 依赖 TASK-010（单中心基线）
- TASK-017 依赖 TASK-011（实验结果）

### 资源需求
- **GPU**: 必需（PANDA模型训练）
- **内存**: 16GB+（多中心数据处理）
- **存储**: 10GB+（实验结果和模型）

---

## 📞 联系信息

**项目负责人**: [待填写]
**技术负责人**: [待填写]
**医学顾问**: [待填写]
**更新频率**: 每周更新进度

---

*最后更新: 2025-11-18*
*版本: v1.0*